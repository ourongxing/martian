"use strict";var Y=Object.create;var f=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var J=(e,t)=>{for(var r in t)f(e,r,{get:t[r],enumerable:!0})},R=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of G(t))!F.call(e,n)&&n!==r&&f(e,n,{get:()=>t[n],enumerable:!(o=$(t,n))||o.enumerable});return e};var m=(e,t,r)=>(r=e!=null?Y(z(e)):{},R(t||!e||!e.__esModule?f(r,"default",{value:e,enumerable:!0}):r,e)),Q=e=>R(f({},"__esModule",{value:!0}),e);var me={};J(me,{markdownToBlocks:()=>de,markdownToRichText:()=>fe});module.exports=Q(me);var k=require("unified"),T=m(require("remark-parse"));var _={abap:"abap",sh:"shell","shell-script":"shell",bash:"shell",zsh:"shell",text:"vb.net",c_cpp:"c++",clojure:"clojure",coffee:"coffeescript","coffee-script":"coffeescript",cpp:"c++",csharp:"c#",cake:"c#",cakescript:"c#",css:"css",dart:"dart",diff:"diff",udiff:"diff",dockerfile:"docker",elixir:"elixir",elm:"elm",erlang:"erlang",fsharp:"f#",cucumber:"gherkin",glsl:"glsl",golang:"go",groovy:"groovy",haskell:"haskell",html:"html",xhtml:"html",java:"java/c/c++/c#",javascript:"javascript",js:"javascript",node:"javascript",json:"json",julia:"julia",tex:"latex",latex:"latex",less:"less",lisp:"webassembly",livescript:"livescript","live-script":"livescript",ls:"livescript",lua:"lua",makefile:"makefile",bsdmake:"makefile",make:"makefile",mf:"makefile",markdown:"markdown",pandoc:"markdown",matlab:"matlab",octave:"matlab",nix:"nix",nixos:"nix",objectivec:"objective-c","obj-c":"objective-c",objc:"objective-c",ocaml:"ocaml",pascal:"pascal",delphi:"pascal",objectpascal:"pascal",perl:"perl",cperl:"perl",php:"php",inc:"php",powershell:"powershell",posh:"powershell",pwsh:"powershell",prolog:"prolog",protobuf:"protobuf","Protocol Buffers":"protobuf",python:"python",python3:"python",rusthon:"python",r:"r",R:"r",Rscript:"r",splus:"r",rust:"rust",ruby:"ruby",jruby:"ruby",macruby:"ruby",rake:"ruby",rb:"ruby",rbx:"ruby",rs:"rust",sass:"sass",scala:"scala",scheme:"scheme",scss:"scss",sql:"sql",typescript:"typescript",ts:"typescript","visual basic":"vb.net",vbnet:"vb.net","vb .net":"vb.net","vb.net":"vb.net",verilog:"verilog",vhdl:"vhdl",wast:"webassembly",wasm:"webassembly",xml:"xml",rss:"xml",xsd:"xml",wsdl:"xml",yaml:"yaml",yml:"yaml"};var l={PAYLOAD_BLOCKS:1e3,RICH_TEXT_ARRAYS:100,RICH_TEXT:{TEXT_CONTENT:2e3,LINK_URL:1e3,EQUATION_EXPRESSION:1e3}};function Z(e){return!e||e===""?!1:/^https?:\/\/.+/i.test(e)}function u(e,t={}){let r={bold:!1,strikethrough:!1,underline:!1,italic:!1,code:!1,color:"default",...t.annotations||{}};return t.type==="equation"?{type:"equation",annotations:r,equation:{expression:e}}:{type:"text",annotations:r,text:{content:e,link:Z(t.url)?{type:"url",url:t.url}:void 0}}}var ee=["abap","arduino","bash","basic","c","clojure","coffeescript","c++","c#","css","dart","diff","docker","elixir","elm","erlang","flow","fortran","f#","gherkin","glsl","go","graphql","groovy","haskell","html","java","javascript","json","julia","kotlin","latex","less","lisp","livescript","lua","makefile","markdown","markup","matlab","mermaid","nix","objective-c","ocaml","pascal","perl","php","plain text","powershell","prolog","protobuf","python","r","reason","ruby","rust","sass","scala","scheme","scss","shell","sql","swift","typescript","vb.net","verilog","vhdl","visual basic","webassembly","xml","yaml","java/c/c++/c#"];function B(e){return ee.includes(e)}function C(){return{object:"block",type:"divider",divider:{}}}function x(e){return{object:"block",type:"paragraph",paragraph:{rich_text:e}}}function w(e,t="plain text"){return{object:"block",type:"code",code:{rich_text:e,language:t}}}function v(e=[],t=[]){return{object:"block",type:"quote",quote:{rich_text:e.length?e:[u("")],children:t}}}function b(e){return{object:"block",type:"image",image:{type:"external",external:{url:e}}}}function L(){return{object:"block",type:"table_of_contents",table_of_contents:{}}}function j(e){return{object:"block",type:"heading_1",heading_1:{rich_text:e}}}function O(e){return{object:"block",type:"heading_2",heading_2:{rich_text:e}}}function E(e){return{object:"block",type:"heading_3",heading_3:{rich_text:e}}}function I(e,t=[]){return{object:"block",type:"bulleted_list_item",bulleted_list_item:{rich_text:e,children:t.length?t:void 0}}}function A(e,t=[]){return{object:"block",type:"numbered_list_item",numbered_list_item:{rich_text:e,children:t.length?t:void 0}}}function N(e,t,r=[]){return{object:"block",type:"to_do",to_do:{rich_text:t,checked:e,children:r.length?r:void 0}}}function q(e,t){return{object:"block",type:"table",table:{table_width:t,has_column_header:!0,children:e!=null&&e.length?e:[]}}}function M(e=[]){return{object:"block",type:"table_row",table_row:{cells:e.length?e:[]}}}function S(e){return{type:"equation",equation:{expression:e}}}function P(e){return e?_[e.toLowerCase()]:void 0}var U=m(require("path")),X=require("url");function H(e,t){return(e.match(/[^]{1,2000}/g)||[]).flatMap(o=>u(o,t))}function re(e){if(e)return e=e.toLowerCase(),B(e)?e:P(e)}function s(e,t){var o;let r={annotations:{...(o=t==null?void 0:t.annotations)!=null?o:{}},url:t==null?void 0:t.url};switch(e.type){case"text":return H(e.value,r);case"delete":return r.annotations.strikethrough=!0,e.children.flatMap(n=>s(n,r));case"emphasis":return r.annotations.italic=!0,e.children.flatMap(n=>s(n,r));case"strong":return r.annotations.bold=!0,e.children.flatMap(n=>s(n,r));case"link":return r.url=e.url,e.children.flatMap(n=>s(n,r));case"inlineCode":return r.annotations.code=!0,[u(e.value,r)];case"inlineMath":return[u(e.value,{...r,type:"equation"})];default:return[]}}function ne(e,t){var n;let r=[".png",".jpg",".jpeg",".gif",".tif",".tiff",".bmp",".svg",".heic",".webp"];function o(){return x([u(e.url)])}try{if((n=t.strictImageUrls)==null||n){let i=new X.URL(e.url),a=U.default.extname(i.pathname);return r.includes(a)?b(e.url):o()}else return b(e.url)}catch(i){return o()}}function oe(e,t){if(e.children.length>2&&e.children[0].type==="text"&&e.children[0].value==="[["&&e.children[1].type==="emphasis"&&e.children[1].children[0].value==="TOC")return[L()];let o=[],n=[];return e.children.forEach(i=>{if(i.type==="image")o.push(ne(i,t));else{let a=s(i);a.length&&n.push(a)}}),n.length?[x(n.flat()),...o]:o}function ie(e,t){let r=e.children.flatMap(o=>g(o,t));return v([],r)}function ae(e){let t=e.children.flatMap(r=>s(r));switch(e.depth){case 1:return j(t);case 2:return O(t);default:return E(t)}}function ce(e){let t=H(e.value),r=re(e.lang);return w(t,r)}function le(e,t){return e.children.flatMap(r=>{let o=r.children.shift();if(o===void 0||o.type!=="paragraph")return[];let n=o.children.flatMap(a=>s(a)),i=r.children.flatMap(a=>g(a,t));return e.start!==null&&e.start!==void 0?[A(n,i)]:r.checked!==null&&r.checked!==void 0?[N(r.checked,n,i)]:[I(n,i)]})}function se(e){return[e.children.flatMap(t=>s(t))]}function ue(e){let t=e.children.flatMap(r=>se(r));return[M(t)]}function pe(e){var o;let t=(o=e.children)!=null&&o.length?e.children[0].children.length:0,r=e.children.flatMap(n=>ue(n));return[q(r,t)]}function he(e){let t=e.value.split(`
`).join(`\\\\
`);return S(t)}function g(e,t){switch(e.type){case"heading":return[ae(e)];case"paragraph":return oe(e,t);case"code":return[ce(e)];case"blockquote":return[ie(e,t)];case"list":return le(e,t);case"table":return pe(e);case"math":return[he(e)];case"thematicBreak":return[C()];default:return[]}}function W(e,t){var i,a,p,h;let r=e.children.flatMap(c=>g(c,t||{})),o=!!((a=(i=t==null?void 0:t.notionLimits)==null?void 0:i.truncate)==null||a),n=(h=(p=t==null?void 0:t.notionLimits)==null?void 0:p.onError)!=null?h:()=>{};return r.length>l.PAYLOAD_BLOCKS&&n(new Error(`Resulting blocks array exceeds Notion limit (${l.PAYLOAD_BLOCKS})`)),o?r.slice(0,l.PAYLOAD_BLOCKS):r}function D(e,t){var i,a,p,h;let r=[];e.children.forEach(c=>{if(c.type==="paragraph")c.children.forEach(d=>r.push(...s(d)));else if((t==null?void 0:t.nonInline)==="throw")throw new Error(`Unsupported markdown element: ${JSON.stringify(c)}`)});let o=!!((a=(i=t==null?void 0:t.notionLimits)==null?void 0:i.truncate)==null||a),n=(h=(p=t==null?void 0:t.notionLimits)==null?void 0:p.onError)!=null?h:()=>{};return r.length>l.RICH_TEXT_ARRAYS&&n(new Error(`Resulting richTexts array exceeds Notion limit (${l.RICH_TEXT_ARRAYS})`)),(o?r.slice(0,l.RICH_TEXT_ARRAYS):r).map(c=>{var d;return c.type!=="text"||(c.text.content.length>l.RICH_TEXT.TEXT_CONTENT&&(n(new Error(`Resulting text content exceeds Notion limit (${l.RICH_TEXT.TEXT_CONTENT})`)),o&&(c.text.content=c.text.content.slice(0,l.RICH_TEXT.TEXT_CONTENT-3)+"...")),(d=c.text.link)!=null&&d.url&&c.text.link.url.length>l.RICH_TEXT.LINK_URL&&n(new Error(`Resulting text URL exceeds Notion limit (${l.RICH_TEXT.LINK_URL})`))),c})}var y=m(require("remark-gfm")),K=m(require("remark-math"));function de(e,t){let r=(0,k.unified)().use(T.default).use(y.default).use(K.default).parse(e);return W(r,t)}function fe(e,t){let r=(0,k.unified)().use(T.default).use(y.default).parse(e);return D(r,t)}0&&(module.exports={markdownToBlocks,markdownToRichText});
